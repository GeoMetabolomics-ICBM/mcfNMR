Running HiGHS 1.2.0 [date: 2021-07-09, git hash: n/a]
Copyright (c) 2022 ERGO-Code under MIT licence terms
Presolving model
15132 rows, 142929 cols, 284565 nonzeros
15066 rows, 142793 cols, 284532 nonzeros
Presolve : Reductions: rows 15066(-26820); columns 142793(-156226); elements 284532(-316355)
Solving the presolved LP
Using EKK dual simplex solver - serial
  Iteration        Objective     Infeasibilities num(sum)
          0     0.0000000000e+00 Pr: 1(2.86858e+09) 0s
       5665     1.3224760844e+06 Pr: 1479(6.65529e+09) 5s
       8669     1.7808881478e+06 Pr: 1660(3.05803e+09); Du: 0(2.74273e-08) 10s
      11310     2.1789984106e+06 Pr: 1714(2.54178e+09) 15s
      13886     2.6042380165e+06 Pr: 1613(1.31291e+08) 20s
      16321     3.0035029865e+06 Pr: 1670(9.15742e+09) 25s
      18806     3.4769604224e+06 Pr: 1633(6.46113e+09); Du: 0(8.94728e-08) 31s
      21187     4.0241887330e+06 Pr: 1594(1.14535e+10); Du: 0(7.22193e-08) 36s
      23585     4.7574065238e+06 Pr: 1683(1.16246e+10); Du: 0(8.94728e-08) 41s
      26009     5.6263382596e+06 Pr: 1615(2.3848e+10); Du: 0(5.37533e-08) 46s
      28479     6.8562158297e+06 Pr: 1620(3.192e+10); Du: 0(4.73084e-09) 51s
      31032     8.3220626276e+06 Pr: 1546(4.69587e+09); Du: 0(8.46683e-08) 56s
      33634     1.0752949275e+07 Pr: 1588(7.29064e+09); Du: 0(2.44888e-08) 61s
      36140     1.4570374933e+07 Pr: 1621(2.51783e+10); Du: 0(1.0586e-07) 66s
      38661     2.2748912729e+07 Pr: 1598(2.37969e+10); Du: 0(9.53257e-08) 71s
      41283     8.5238826570e+07 Pr: 1613(1.61947e+11); Du: 0(9.53257e-08) 76s
      43961     1.4774076960e+13 Pr: 1609(2.60565e+09); Du: 0(9.86917e-08) 82s
      46560     1.5133318650e+13 Pr: 1469(7.00034e+08); Du: 0(9.68012e-10) 87s
      49326     1.5609673187e+13 Pr: 1474(3.35314e+09); Du: 0(3.92663e-10) 92s
      52305     1.6021942213e+13 Pr: 1388(8.56243e+08); Du: 0(3.92663e-10) 97s
      55142     1.6293915502e+13 Pr: 1447(5.73637e+08); Du: 0(5.55112e-17) 102s
      58212     1.6562557571e+13 Pr: 1385(1.05629e+09); Du: 0(8.08564e-08) 107s
      61831     1.6783120873e+13 Pr: 1249(5.3594e+07); Du: 0(8.08564e-08) 113s
      64826     1.6890183808e+13 Pr: 1317(1.68125e+08); Du: 0(8.08564e-08) 118s
      68302     1.7047364317e+13 Pr: 1217(6.79406e+08) 123s
      73849     1.7155589414e+13 Pr: 972(6.19632e+06); Du: 0(2.3728e-09) 128s
      78089     1.7183671778e+13 Pr: 0(0); Du: 0(1.04826e-08) 130s
Solving the original LP from the solution after postsolve
Model   status      : Optimal
Simplex   iterations: 78089
Objective value     :  1.7183671778e+13
HiGHS run time      :        130.90
config: Enforcing numpy legacy print mode to ensure that numpy floats are printed without type information.
Test run ...

args:
Namespace(outdir='output', config='test_config.toml')

Working directory: /home/leo/.texttest/tmp/mcfnmr.19Feb193500.14106/mcfnmr/classification/setupA_more_cases/N925/large_radius_and_small_thresh

config:
{'ar': 0.15,
 'lib': 'MetaboMiner',
 'mix': 'N925',
 'setup': 'A',
 'task': 'classification',
 'th': 0.001}

Writing output to: /home/leo/.texttest/tmp/mcfnmr.19Feb193500.14106/mcfnmr/classification/setupA_more_cases/N925/large_radius_and_small_thresh/output

Data directory: /home/leo/repos/mcfnmr-release/data
Loaded mix 'N926' content list of length 35
Loaded mix 'N907' content list of length 35
Loaded mix 'N987' content list of length 21
Loaded mix 'N925' content list of length 27
Loaded mix 'N988' content list of length 24
Loaded mix 'N880' content list of length 27
Loading MM lib 'Biofluid ( all )' containing 502 compounds...
Removing duplicate entry for D-Lactic Acid (HMDB 1311)
Loaded data from '/home/leo/repos/mcfnmr-release/data/MetaboMiner/processedUCSF/N925.pickle'
Original grid dimension: (1024, 2048)
Noise Std before processing: 10.4142
Noise Std after processing: 10.4142
   Total avg point intensity: 2.48352e+07
   Max point intensity: 153965
   Noise std: 10.4142
   Signal to noise: 14784.1

Converting raster to peaks, nbin=(2, 4), signal-to-noise threshold=None)
   (original raster dimensions: (1024, 2048))
   (binned grid dimensions: (512, 512))
runMetaboMinerFits(): Binning for mix N925: (2, 4)
Making dist list for ar=0.15 ...
len(distList): 295616
Saved distlists to '/home/leo/repos/mcfnmr-release/output/cache/mcf/dist_list_N925(raster, (2x4)-bins)_MetaboMiner_ar0.15.pickle'
makeDistList() took 0.85722 secs
Checking containment...
Saved indices to /home/leo/repos/mcfnmr-release/output/cache/mcf/lib MetaboMiner in N925(raster, (2x4)-bins)_region_ix.pickle
Saved indices to /home/leo/repos/mcfnmr-release/output/cache/mcf/N925(raster, (2x4)-bins)_region_ix.pickle
Containment checking took 4.10352 secs
Generating flow net...
No peak of 132 in considered region.
No peak of 1366 in considered region.
No peak of 142 in considered region.
No peak of 157 in considered region.
No peak of 292 in considered region.
No peak of 34 in considered region.
No peak of 4816 in considered region.

Total connected target nodes: 35190
Total target weight: 4.48216e+07

Generated flowNet:
 DiGraph with 39037 nodes and 299019 edges
Generation took 0.894234 secs
Calculating min cost flow...
Constructing A_eq...
Number of dead end compounds: 7 / 501
   took 0.52414 secs
Constructing A_ub...
Estimated number of inequalities: 35190 (nr of connected target nodes).
True number of inequalities is 35190.
   took 2.34827 secs
Running linprog()...
   took 131.002 secs

linprog:
Optimization terminated successfully. (HiGHS Status 7: Optimal)
Min-cost-flow calculation took 134.222 secs
Collecting stats...
Total absorbed flow: 1.71837e+07
Total flows:
   absorbed: 1.71837e+07
   assigned: 2.76379e+07
Total costs:
 assignment: 1.75404e+06
 absorption: 1.71837e+13
      total: 1.71837e+13
Stats collection took 0.388302 secs


Timings (at nX=3486, nY=262144):
distList: 0.85722 secs
containmentCheck: 4.10352 secs
flowNetGeneration: 0.894234 secs
minCostFlow: 134.222 secs
statsCollection: 0.388302 secs
Saved MCF result to '/home/leo/repos/mcfnmr-release/output/cache_demo_routines/mcfResult_joint_in_N925(raster, (2x4)-bins)_lib_MetaboMiner_ar0.15.pickle'
Total time for MCF: 140.619 secs

Classification results:
{'N925': {'classification': {'FN': ['122', '158', '172', '357', '641', '72'],
                             'FP': ['1051',
                                    '1058',
                                    '1065',
                                    '1151',
                                    '1201',
                                    '124',
                                    '1266',
                                    '127',
                                    '1294',
                                    '1401',
                                    '1487',
                                    '1511',
                                    '1563',
                                    '1565',
                                    '1586',
                                    '163',
                                    '1645',
                                    '1721',
                                    '174',
                                    '1844',
                                    '1851',
                                    '1868',
                                    '187',
                                    '1885',
                                    '1894',
                                    '2',
                                    '2005',
                                    '210',
                                    '211',
                                    '2128',
                                    '2141',
                                    '215',
                                    '224',
                                    '251',
                                    '258',
                                    '272',
                                    '283',
                                    '2917',
                                    '2923',
                                    '2928',
                                    '299',
                                    '310',
                                    '329',
                                    '370',
                                    '4110',
                                    '4437',
                                    '473',
                                    '4987',
                                    '538',
                                    '55',
                                    '61',
                                    '640',
                                    '670',
                                    '679',
                                    '76',
                                    '8',
                                    '828',
                                    '849',
                                    '904',
                                    '925',
                                    '943',
                                    '98'],
                             'TP': ['108',
                                    '159',
                                    '161',
                                    '162',
                                    '167',
                                    '177',
                                    '182',
                                    '190',
                                    '191',
                                    '195',
                                    '214',
                                    '300',
                                    '43',
                                    '517',
                                    '62',
                                    '687',
                                    '696',
                                    '812',
                                    '883',
                                    '929',
                                    '97'],
                             'compound_df':     compound target  ... intensity scaling  expected concentration factor
0          1   N925  ...              None                           None
1        101   N925  ...              None                           None
2       1044   N925  ...              None                           None
3       1046   N925  ...              None                           None
4       1049   N925  ...              None                           None
..       ...    ...  ...               ...                            ...
496       97   N925  ...              None                           None
497      975   N925  ...              None                           None
498       98   N925  ...              None                           None
499       99   N925  ...              None                           None
500      995   N925  ...              None                           None

[501 rows x 15 columns],
                             'fscore': 0.3818181818181818,
                             'precision': 0.25301204819277107,
                             'recall': 0.7777777777777778},
          'classificationThreshold': 0.001}}

 Total run time: 143.4162735939026 secs
