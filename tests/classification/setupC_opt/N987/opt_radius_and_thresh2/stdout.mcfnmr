Running HiGHS 1.2.0 [date: 2021-07-09, git hash: n/a]
Copyright (c) 2022 ERGO-Code under MIT licence terms
Presolving model
295 rows, 503 cols, 798 nonzeros
107 rows, 327 cols, 533 nonzeros
75 rows, 267 cols, 390 nonzeros
67 rows, 255 cols, 378 nonzeros
Presolve : Reductions: rows 67(-11234); columns 255(-10171); elements 378(-23327)
Solving the presolved LP
Using EKK dual simplex solver - serial
  Iteration        Objective     Infeasibilities num(sum)
          0     0.0000000000e+00 Pr: 1(4.486e+08) 0s
         77     1.2869754915e+13 Pr: 0(0) 0s
Solving the original LP from the solution after postsolve
Using EKK primal simplex solver
  Iteration        Objective     Infeasibilities num(sum)
         77     1.2869754915e+13 Pr: 0(0); Du: 1(3.10961e-07) 0s
         77     1.2869754915e+13 Pr: 0(0); Du: 1(3.10961e-07) 0s
Model   status      : Optimal
Simplex   iterations: 77
Objective value     :  1.2869754915e+13
HiGHS run time      :          0.02
Running HiGHS 1.2.0 [date: 2021-07-09, git hash: n/a]
Copyright (c) 2022 ERGO-Code under MIT licence terms
Presolving model
868 rows, 1874 cols, 3123 nonzeros
571 rows, 1491 cols, 2770 nonzeros
476 rows, 1228 cols, 2199 nonzeros
437 rows, 1143 cols, 2096 nonzeros
Presolve : Reductions: rows 437(-14726); columns 1143(-17443); elements 2096(-37929)
Solving the presolved LP
Using EKK dual simplex solver - serial
  Iteration        Objective     Infeasibilities num(sum)
          0     0.0000000000e+00 Pr: 1(4.11832e+08) 0s
        414     1.1812718829e+13 Pr: 0(0) 0s
Solving the original LP from the solution after postsolve
Using EKK primal simplex solver
  Iteration        Objective     Infeasibilities num(sum)
        414     1.1812718829e+13 Pr: 0(0); Du: 3(6.54761e-07) 0s
        414     1.1812718829e+13 Pr: 0(0); Du: 3(6.54761e-07) 0s
Model   status      : Optimal
Simplex   iterations: 414
Objective value     :  1.1812718829e+13
HiGHS run time      :          0.04
Running HiGHS 1.2.0 [date: 2021-07-09, git hash: n/a]
Copyright (c) 2022 ERGO-Code under MIT licence terms
Presolving model
1649 rows, 3896 cols, 6721 nonzeros
1243 rows, 3172 cols, 6015 nonzeros
1101 rows, 2776 cols, 5244 nonzeros
Presolve : Reductions: rows 1101(-18092); columns 2776(-27305); elements 5244(-57771)
Solving the presolved LP
Using EKK dual simplex solver - serial
  Iteration        Objective     Infeasibilities num(sum)
          0     0.0000000000e+00 Pr: 1(3.78007e+08) 0s
        874     1.0792600550e+13 Pr: 0(0); Du: 0(1.1856e-08) 0s
Solving the original LP from the solution after postsolve
Using EKK primal simplex solver
  Iteration        Objective     Infeasibilities num(sum)
        874     1.0792600550e+13 Pr: 0(0); Du: 3(8.94038e-07) 0s
        874     1.0792600550e+13 Pr: 0(0); Du: 3(8.94038e-07) 0s
Model   status      : Optimal
Simplex   iterations: 874
Objective value     :  1.0792600550e+13
HiGHS run time      :          0.08
config: Enforcing numpy legacy print mode to ensure that numpy floats are printed without type information.
Test run ...

args:
Namespace(outdir='output', config='test_config.toml')

Working directory: /home/leo/.texttest/tmp/mcfnmr.19Feb193500.14106/mcfnmr/classification/setupC_opt/N987/opt_radius_and_thresh2

config:
{'ar': 0.15,
 'lib': 'MetaboMiner',
 'mix': 'N987',
 'setup': 'C',
 'task': 'classification',
 'th': 0.007}

Writing output to: /home/leo/.texttest/tmp/mcfnmr.19Feb193500.14106/mcfnmr/classification/setupC_opt/N987/opt_radius_and_thresh2/output

Data directory: /home/leo/repos/mcfnmr-release/data
Loaded mix 'N926' content list of length 35
Loaded mix 'N907' content list of length 35
Loaded mix 'N987' content list of length 21
Loaded mix 'N925' content list of length 27
Loaded mix 'N988' content list of length 24
Loaded mix 'N880' content list of length 27
Loaded data from '/home/leo/repos/mcfnmr-release/data/MetaboMiner/processedUCSF/N987.pickle'
Original grid dimension: (512, 1024)
Noise Std before processing: 9.70559
Noise Std after processing: 9.70559
   Total avg point intensity: 6.8398e+06
   Max point intensity: 46585.5
   Noise std: 9.70559
   Signal to noise: 4799.86

Converting raster to peaks, nbin=(1, 2), signal-to-noise threshold=None)
   (original raster dimensions: (512, 1024))
   (binned grid dimensions: (512, 512))
Loading MM lib 'Biofluid ( all )' containing 502 compounds...
Removing duplicate entry for D-Lactic Acid (HMDB 1311)
runMetaboMinerFits(): Binning for mix N987: (1, 2)

Incremental fit:
   total reserved capacity: 0
    min/max: 0/0

Making dist list for ar=0.02 ...
len(distList): 6578
Saved distlists to '/home/leo/repos/mcfnmr-release/output/cache/mcf/dist_list_N987(raster, (1x2)-bins)_MetaboMiner_ar0.02.pickle'
makeDistList() took 0.362315 secs
Checking containment...
Saved indices to /home/leo/repos/mcfnmr-release/output/cache/mcf/lib MetaboMiner in N987(raster, (1x2)-bins)_region_ix.pickle
Saved indices to /home/leo/repos/mcfnmr-release/output/cache/mcf/N987(raster, (1x2)-bins)_region_ix.pickle
Containment checking took 3.85305 secs
Generating flow net...
No peak of 132 in considered region.
No peak of 1366 in considered region.
No peak of 142 in considered region.
No peak of 157 in considered region.
No peak of 292 in considered region.
No peak of 34 in considered region.
No peak of 4816 in considered region.

Total connected target nodes: 4597
Total target weight: 1.40188e+07

Generated flowNet:
 DiGraph with 8448 nodes and 10426 edges
Generation took 0.226179 secs
Calculating min cost flow...
Constructing A_eq...
Number of dead end compounds: 7 / 501
   took 0.313135 secs
Constructing A_ub...
Estimated number of inequalities: 4597 (nr of connected target nodes).
True number of inequalities is 4597.
   took 0.237382 secs
Running linprog()...
   took 0.0295362 secs

linprog:
Optimization terminated successfully. (HiGHS Status 7: Optimal)
Min-cost-flow calculation took 0.593079 secs
Collecting stats...
Total absorbed flow: 1.28698e+07
Total flows:
   absorbed: 1.28698e+07
   assigned: 1.149e+06
Total costs:
 assignment: 13366.3
 absorption: 1.28698e+13
      total: 1.28698e+13
Stats collection took 0.239404 secs


Timings (at nX=3486, nY=262144):
distList: 0.362315 secs
containmentCheck: 3.85305 secs
flowNetGeneration: 0.226179 secs
minCostFlow: 0.593079 secs
statsCollection: 0.239404 secs
Saved MCF result to '/home/leo/repos/mcfnmr-release/output/cache_demo_routines/mcfResult_joint_in_N987(raster, (1x2)-bins)_lib_MetaboMiner_0.02on[].pickle'
Total time for MCF: 5.47595 secs

Saved updated result to '/home/leo/repos/mcfnmr-release/output/cache_demo_routines/mcfResult_joint_in_N987(raster, (1x2)-bins)_lib_MetaboMiner_0.02on[].pickle'

Incremental fit:
   total reserved capacity: 1.149e+06
    min/max: 0/43862.9

Making dist list for ar=0.03 ...
len(distList): 14745
Saved distlists to '/home/leo/repos/mcfnmr-release/output/cache/mcf/dist_list_N987(raster, (1x2)-bins)_MetaboMiner_ar0.03.pickle'
makeDistList() took 0.41608 secs
Checking containment...
Saved indices to /home/leo/repos/mcfnmr-release/output/cache/mcf/lib MetaboMiner in N987(raster, (1x2)-bins)_region_ix.pickle
Saved indices to /home/leo/repos/mcfnmr-release/output/cache/mcf/N987(raster, (1x2)-bins)_region_ix.pickle
Containment checking took 3.83202 secs
Generating flow net...
No peak of 132 in considered region.
No peak of 1366 in considered region.
No peak of 142 in considered region.
No peak of 157 in considered region.
No peak of 292 in considered region.
No peak of 34 in considered region.
No peak of 4816 in considered region.

Total connected target nodes: 8459
Total target weight: 1.28698e+07

Generated flowNet:
 DiGraph with 12310 nodes and 18586 edges
Generation took 0.189436 secs
Calculating min cost flow...
Constructing A_eq...
Number of dead end compounds: 7 / 501
   took 0.390985 secs
Constructing A_ub...
Estimated number of inequalities: 8459 (nr of connected target nodes).
True number of inequalities is 8459.
   took 0.419455 secs
Running linprog()...
   took 0.0527791 secs

linprog:
Optimization terminated successfully. (HiGHS Status 7: Optimal)
Min-cost-flow calculation took 0.886336 secs
Collecting stats...
Total absorbed flow: 1.18127e+07
Total flows:
   absorbed: 1.18127e+07
   assigned: 1.05704e+06
Total costs:
 assignment: 18376.1
 absorption: 1.18127e+13
      total: 1.18127e+13
Stats collection took 0.254491 secs


Timings (at nX=3486, nY=262144):
distList: 0.41608 secs
containmentCheck: 3.83202 secs
flowNetGeneration: 0.189436 secs
minCostFlow: 0.886336 secs
statsCollection: 0.254491 secs
Saved MCF result to '/home/leo/repos/mcfnmr-release/output/cache_demo_routines/mcfResult_joint_in_N987(raster, (1x2)-bins)_lib_MetaboMiner_0.03on[0.02].pickle'
Total time for MCF: 5.72171 secs

Saved updated result to '/home/leo/repos/mcfnmr-release/output/cache_demo_routines/mcfResult_joint_in_N987(raster, (1x2)-bins)_lib_MetaboMiner_0.03on[0.02].pickle'
Saved updated result to '/home/leo/repos/mcfnmr-release/output/cache_demo_routines/mcfResult_joint_in_N987(raster, (1x2)-bins)_lib_MetaboMiner_0.02on[].pickle'

Incremental fit:
   total reserved capacity: 2.20603e+06
    min/max: 0/69118

Making dist list for ar=0.04 ...
len(distList): 26247
Saved distlists to '/home/leo/repos/mcfnmr-release/output/cache/mcf/dist_list_N987(raster, (1x2)-bins)_MetaboMiner_ar0.04.pickle'
makeDistList() took 0.417142 secs
Checking containment...
Saved indices to /home/leo/repos/mcfnmr-release/output/cache/mcf/lib MetaboMiner in N987(raster, (1x2)-bins)_region_ix.pickle
Saved indices to /home/leo/repos/mcfnmr-release/output/cache/mcf/N987(raster, (1x2)-bins)_region_ix.pickle
Containment checking took 3.87354 secs
Generating flow net...
No peak of 132 in considered region.
No peak of 1366 in considered region.
No peak of 142 in considered region.
No peak of 157 in considered region.
No peak of 292 in considered region.
No peak of 34 in considered region.
No peak of 4816 in considered region.

Total connected target nodes: 12489
Total target weight: 1.18127e+07

Generated flowNet:
 DiGraph with 16340 nodes and 30081 edges
Generation took 0.292781 secs
Calculating min cost flow...
Constructing A_eq...
Number of dead end compounds: 7 / 501
   took 0.336734 secs
Constructing A_ub...
Estimated number of inequalities: 12489 (nr of connected target nodes).
True number of inequalities is 12489.
   took 0.678984 secs
Running linprog()...
   took 0.0899675 secs

linprog:
Optimization terminated successfully. (HiGHS Status 7: Optimal)
Min-cost-flow calculation took 1.14163 secs
Collecting stats...
Total absorbed flow: 1.07926e+07
Total flows:
   absorbed: 1.07926e+07
   assigned: 1.02012e+06
Total costs:
 assignment: 25269.1
 absorption: 1.07926e+13
      total: 1.07926e+13
Stats collection took 0.282763 secs


Timings (at nX=3486, nY=262144):
distList: 0.417142 secs
containmentCheck: 3.87354 secs
flowNetGeneration: 0.292781 secs
minCostFlow: 1.14163 secs
statsCollection: 0.282763 secs
Saved MCF result to '/home/leo/repos/mcfnmr-release/output/cache_demo_routines/mcfResult_joint_in_N987(raster, (1x2)-bins)_lib_MetaboMiner_0.04on[0.02,0.03].pickle'
Running HiGHS 1.2.0 [date: 2021-07-09, git hash: n/a]
Copyright (c) 2022 ERGO-Code under MIT licence terms
Presolving model
2963 rows, 7722 cols, 14081 nonzeros
2566 rows, 6958 cols, 13459 nonzeros
Presolve : Reductions: rows 2566(-20530); columns 6958(-37790); elements 13459(-78890)
Solving the presolved LP
Using EKK dual simplex solver - serial
  Iteration        Objective     Infeasibilities num(sum)
          0     0.0000000000e+00 Pr: 1(1.72682e+08) 0s
       1780     9.5858762553e+12 Pr: 0(0) 0s
Solving the original LP from the solution after postsolve
Model   status      : Optimal
Simplex   iterations: 1780
Objective value     :  9.5858762553e+12
HiGHS run time      :          0.13
Running HiGHS 1.2.0 [date: 2021-07-09, git hash: n/a]
Copyright (c) 2022 ERGO-Code under MIT licence terms
Presolving model
3012 rows, 8669 cols, 15578 nonzeros
2512 rows, 7416 cols, 14251 nonzeros
2502 rows, 7379 cols, 14205 nonzeros
Presolve : Reductions: rows 2502(-24256); columns 7379(-55457); elements 14205(-114320)
Solving the presolved LP
Using EKK dual simplex solver - serial
  Iteration        Objective     Infeasibilities num(sum)
          0     0.0000000000e+00 Pr: 1(3.06748e+08) 0s
       1716     8.8970879593e+12 Pr: 0(0); Du: 0(1.08903e-09) 0s
Solving the original LP from the solution after postsolve
Using EKK primal simplex solver
  Iteration        Objective     Infeasibilities num(sum)
       1716     8.8970879593e+12 Pr: 0(0); Du: 3(1.54033e-06) 0s
       1716     8.8970879593e+12 Pr: 0(0); Du: 3(1.54033e-06) 0s
Model   status      : Optimal
Simplex   iterations: 1716
Objective value     :  8.8970879593e+12
HiGHS run time      :          0.17
Running HiGHS 1.2.0 [date: 2021-07-09, git hash: n/a]
Copyright (c) 2022 ERGO-Code under MIT licence terms
Presolving model
6619 rows, 23300 cols, 44558 nonzeros
6294 rows, 22800 cols, 44784 nonzeros
Presolve : Reductions: rows 6294(-27016); columns 22800(-85853); elements 44784(-175375)
Solving the presolved LP
Using EKK dual simplex solver - serial
  Iteration        Objective     Infeasibilities num(sum)
          0     0.0000000000e+00 Pr: 1(2.84707e+08) 0s
       5871     8.1883068726e+12 Pr: 0(0); Du: 0(8.42075e-10) 0s
Solving the original LP from the solution after postsolve
Model   status      : Optimal
Simplex   iterations: 5871
Objective value     :  8.1883068726e+12
HiGHS run time      :          0.79
Total time for MCF: 6.14962 secs

Saved updated result to '/home/leo/repos/mcfnmr-release/output/cache_demo_routines/mcfResult_joint_in_N987(raster, (1x2)-bins)_lib_MetaboMiner_0.04on[0.02,0.03].pickle'
Saved updated result to '/home/leo/repos/mcfnmr-release/output/cache_demo_routines/mcfResult_joint_in_N987(raster, (1x2)-bins)_lib_MetaboMiner_0.03on[0.02].pickle'

Incremental fit:
   total reserved capacity: 3.22615e+06
    min/max: 0/69118

Making dist list for ar=0.05 ...
len(distList): 40923
Saved distlists to '/home/leo/repos/mcfnmr-release/output/cache/mcf/dist_list_N987(raster, (1x2)-bins)_MetaboMiner_ar0.05.pickle'
makeDistList() took 0.448145 secs
Checking containment...
Saved indices to /home/leo/repos/mcfnmr-release/output/cache/mcf/lib MetaboMiner in N987(raster, (1x2)-bins)_region_ix.pickle
Saved indices to /home/leo/repos/mcfnmr-release/output/cache/mcf/N987(raster, (1x2)-bins)_region_ix.pickle
Containment checking took 3.84623 secs
Generating flow net...
No peak of 132 in considered region.
No peak of 1366 in considered region.
No peak of 142 in considered region.
No peak of 157 in considered region.
No peak of 292 in considered region.
No peak of 34 in considered region.
No peak of 4816 in considered region.

Total connected target nodes: 16392
Total target weight: 1.07926e+07

Generated flowNet:
 DiGraph with 20243 nodes and 44748 edges
Generation took 0.328226 secs
Calculating min cost flow...
Constructing A_eq...
Number of dead end compounds: 7 / 501
   took 0.406364 secs
Constructing A_ub...
Estimated number of inequalities: 16392 (nr of connected target nodes).
True number of inequalities is 16392.
   took 0.84169 secs
Running linprog()...
   took 0.143006 secs

linprog:
Optimization terminated successfully. (HiGHS Status 7: Optimal)
Min-cost-flow calculation took 1.44177 secs
Collecting stats...
Total absorbed flow: 9.58588e+06
Total flows:
   absorbed: 9.58588e+06
   assigned: 1.20672e+06
Total costs:
 assignment: 38092.5
 absorption: 9.58588e+12
      total: 9.58588e+12
Stats collection took 0.314106 secs


Timings (at nX=3486, nY=262144):
distList: 0.448145 secs
containmentCheck: 3.84623 secs
flowNetGeneration: 0.328226 secs
minCostFlow: 1.44177 secs
statsCollection: 0.314106 secs
Saved MCF result to '/home/leo/repos/mcfnmr-release/output/cache_demo_routines/mcfResult_joint_in_N987(raster, (1x2)-bins)_lib_MetaboMiner_0.05on[0.02,0.03,0.04].pickle'
Total time for MCF: 6.52229 secs

Saved updated result to '/home/leo/repos/mcfnmr-release/output/cache_demo_routines/mcfResult_joint_in_N987(raster, (1x2)-bins)_lib_MetaboMiner_0.05on[0.02,0.03,0.04].pickle'
Saved updated result to '/home/leo/repos/mcfnmr-release/output/cache_demo_routines/mcfResult_joint_in_N987(raster, (1x2)-bins)_lib_MetaboMiner_0.04on[0.02,0.03].pickle'

Incremental fit:
   total reserved capacity: 4.43288e+06
    min/max: 0/76365.3

Making dist list for ar=0.06 ...
len(distList): 59032
Saved distlists to '/home/leo/repos/mcfnmr-release/output/cache/mcf/dist_list_N987(raster, (1x2)-bins)_MetaboMiner_ar0.06.pickle'
makeDistList() took 0.490359 secs
Checking containment...
Saved indices to /home/leo/repos/mcfnmr-release/output/cache/mcf/lib MetaboMiner in N987(raster, (1x2)-bins)_region_ix.pickle
Saved indices to /home/leo/repos/mcfnmr-release/output/cache/mcf/N987(raster, (1x2)-bins)_region_ix.pickle
Containment checking took 3.90901 secs
Generating flow net...
No peak of 132 in considered region.
No peak of 1366 in considered region.
No peak of 142 in considered region.
No peak of 157 in considered region.
No peak of 292 in considered region.
No peak of 34 in considered region.
No peak of 4816 in considered region.

Total connected target nodes: 20054
Total target weight: 9.58588e+06

Generated flowNet:
 DiGraph with 23905 nodes and 62836 edges
Generation took 0.37131 secs
Calculating min cost flow...
Constructing A_eq...
Number of dead end compounds: 7 / 501
   took 0.432836 secs
Constructing A_ub...
Estimated number of inequalities: 20054 (nr of connected target nodes).
True number of inequalities is 20054.
   took 1.06556 secs
Running linprog()...
   took 0.195755 secs

linprog:
Optimization terminated successfully. (HiGHS Status 7: Optimal)
Min-cost-flow calculation took 1.77409 secs
Collecting stats...
Total absorbed flow: 8.89709e+06
Total flows:
   absorbed: 8.89709e+06
   assigned: 688788
Total costs:
 assignment: 26241.3
 absorption: 8.89709e+12
      total: 8.89709e+12
Stats collection took 0.346284 secs


Timings (at nX=3486, nY=262144):
distList: 0.490359 secs
containmentCheck: 3.90901 secs
flowNetGeneration: 0.37131 secs
minCostFlow: 1.77409 secs
statsCollection: 0.346284 secs
Saved MCF result to '/home/leo/repos/mcfnmr-release/output/cache_demo_routines/mcfResult_joint_in_N987(raster, (1x2)-bins)_lib_MetaboMiner_0.06on[0.02,0.03,0.04,0.05].pickle'
Total time for MCF: 7.03613 secs

Saved updated result to '/home/leo/repos/mcfnmr-release/output/cache_demo_routines/mcfResult_joint_in_N987(raster, (1x2)-bins)_lib_MetaboMiner_0.06on[0.02,0.03,0.04,0.05].pickle'
Saved updated result to '/home/leo/repos/mcfnmr-release/output/cache_demo_routines/mcfResult_joint_in_N987(raster, (1x2)-bins)_lib_MetaboMiner_0.05on[0.02,0.03,0.04].pickle'

Incremental fit:
   total reserved capacity: 5.12166e+06
    min/max: 0/78469.7

Making dist list for ar=0.08 ...
len(distList): 104899
Saved distlists to '/home/leo/repos/mcfnmr-release/output/cache/mcf/dist_list_N987(raster, (1x2)-bins)_MetaboMiner_ar0.08.pickle'
makeDistList() took 0.527765 secs
Checking containment...
Saved indices to /home/leo/repos/mcfnmr-release/output/cache/mcf/lib MetaboMiner in N987(raster, (1x2)-bins)_region_ix.pickle
Saved indices to /home/leo/repos/mcfnmr-release/output/cache/mcf/N987(raster, (1x2)-bins)_region_ix.pickle
Containment checking took 3.85598 secs
Generating flow net...
No peak of 132 in considered region.
No peak of 1366 in considered region.
No peak of 142 in considered region.
No peak of 157 in considered region.
No peak of 292 in considered region.
No peak of 34 in considered region.
No peak of 4816 in considered region.

Total connected target nodes: 26606
Total target weight: 8.89709e+06

Generated flowNet:
 DiGraph with 30457 nodes and 108653 edges
Generation took 0.385983 secs
Calculating min cost flow...
Constructing A_eq...
Number of dead end compounds: 7 / 501
   took 0.389635 secs
Constructing A_ub...
Estimated number of inequalities: 26606 (nr of connected target nodes).
True number of inequalities is 26606.
   took 1.59508 secs
Running linprog()...
   took 0.83842 secs

linprog:
Optimization terminated successfully. (HiGHS Status 7: Optimal)
Min-cost-flow calculation took 2.96538 secs
Collecting stats...
Total absorbed flow: 8.18831e+06
Total flows:
   absorbed: 8.18831e+06
   assigned: 708781
Total costs:
 assignment: 34542.7
 absorption: 8.18831e+12
      total: 8.18831e+12
Stats collection took 0.429681 secs


Timings (at nX=3486, nY=262144):
distList: 0.527765 secs
containmentCheck: 3.85598 secs
flowNetGeneration: 0.385983 secs
minCostFlow: 2.96538 secs
statsCollection: 0.429681 secs
Saved MCF result to '/home/leo/repos/mcfnmr-release/output/cache_demo_routines/mcfResult_joint_in_N987(raster, (1x2)-bins)_lib_MetaboMiner_0.08on[0.02,0.03,0.04,0.05,0.06].pickle'
Total time for MCF: 8.30737 secs

Saved updated result to '/home/leo/repos/mcfnmr-release/output/cache_demo_routines/mcfResult_joint_in_N987(raster, (1x2)-bins)_lib_MetaboMiner_0.08on[0.02,0.03,0.04,0.05,0.06].pickle'
Saved updated result to '/home/leo/repos/mcfnmr-release/output/cache_demo_routines/mcfResult_joint_in_N987(raster, (1x2)-bins)_lib_MetaboMiner_0.06on[0.02,0.03,0.04,0.05].pickle'

Incremental fit:
   total reserved capacity: 5.83044e+06
    min/max: 0/78469.7

Making dist list for ar=0.1 ...
len(distList): 164148
Saved distlists to '/home/leo/repos/mcfnmr-release/output/cache/mcf/dist_list_N987(raster, (1x2)-bins)_MetaboMiner_ar0.1.pickle'
makeDistList() took 0.636887 secs
Checking containment...
Saved indices to /home/leo/repos/mcfnmr-release/output/cache/mcf/lib MetaboMiner in N987(raster, (1x2)-bins)_region_ix.pickle
Running HiGHS 1.2.0 [date: 2021-07-09, git hash: n/a]
Copyright (c) 2022 ERGO-Code under MIT licence terms
Presolving model
4734 rows, 16930 cols, 31514 nonzeros
4418 rows, 16253 cols, 31208 nonzeros
Presolve : Reductions: rows 4418(-34651); columns 16253(-151585); elements 31208(-307321)
Solving the presolved LP
Using EKK dual simplex solver - serial
  Iteration        Objective     Infeasibilities num(sum)
          0     0.0000000000e+00 Pr: 1(5.24052e+08) 0s
       3261     7.7124764002e+12 Pr: 0(0); Du: 0(2.30559e-09) 0s
Solving the original LP from the solution after postsolve
Using EKK primal simplex solver
  Iteration        Objective     Infeasibilities num(sum)
       3261     7.7124764002e+12 Pr: 0(0); Du: 7(3.80905e-06) 0s
       3261     7.7124764002e+12 Pr: 0(0); Du: 7(3.80905e-06) 0s
Model   status      : Optimal
Simplex   iterations: 3261
Objective value     :  7.7124764002e+12
HiGHS run time      :          0.49
Running HiGHS 1.2.0 [date: 2021-07-09, git hash: n/a]
Copyright (c) 2022 ERGO-Code under MIT licence terms
Presolving model
3639 rows, 13604 cols, 24546 nonzeros
3307 rows, 12803 cols, 23729 nonzeros
Presolve : Reductions: rows 3307(-40851); columns 12803(-227164); elements 23729(-459058)
Solving the presolved LP
Using EKK dual simplex solver - serial
  Iteration        Objective     Infeasibilities num(sum)
          0     0.0000000000e+00 Pr: 1(4.93598e+08) 0s
       2352     7.4014615058e+12 Pr: 0(0) 0s
Solving the original LP from the solution after postsolve
Using EKK primal simplex solver
  Iteration        Objective     Infeasibilities num(sum)
       2352     7.4014615058e+12 Pr: 0(0); Du: 3(4.6116e-06) 0s
       2352     7.4014615058e+12 Pr: 0(0); Du: 3(4.6116e-06) 0s
Model   status      : Optimal
Simplex   iterations: 2352
Objective value     :  7.4014615058e+12
HiGHS run time      :          0.51
Running HiGHS 1.2.0 [date: 2021-07-09, git hash: n/a]
Copyright (c) 2022 ERGO-Code under MIT licence terms
Presolving model
4729 rows, 19771 cols, 36375 nonzeros
4545 rows, 19494 cols, 36526 nonzeros
Presolve : Reductions: rows 4545(-46187); columns 19494(-353222); elements 36526(-711759)
Solving the presolved LP
Using EKK dual simplex solver - serial
  Iteration        Objective     Infeasibilities num(sum)
          0     0.0000000000e+00 Pr: 1(4.73694e+08) 0s
       4918     6.8378724763e+12 Pr: 0(0) 0s
Solving the original LP from the solution after postsolve
Model   status      : Optimal
Simplex   iterations: 4918
Objective value     :  6.8378724763e+12
HiGHS run time      :          1.07
Saved indices to /home/leo/repos/mcfnmr-release/output/cache/mcf/N987(raster, (1x2)-bins)_region_ix.pickle
Containment checking took 3.87416 secs
Generating flow net...
No peak of 132 in considered region.
No peak of 1366 in considered region.
No peak of 142 in considered region.
No peak of 157 in considered region.
No peak of 292 in considered region.
No peak of 34 in considered region.
No peak of 4816 in considered region.

Total connected target nodes: 32365
Total target weight: 8.18831e+06

Generated flowNet:
 DiGraph with 36216 nodes and 167838 edges
Generation took 0.506509 secs
Calculating min cost flow...
Constructing A_eq...
Number of dead end compounds: 7 / 501
   took 0.57364 secs
Constructing A_ub...
Estimated number of inequalities: 32365 (nr of connected target nodes).
True number of inequalities is 32365.
   took 1.82822 secs
Running linprog()...
   took 0.558306 secs

linprog:
Optimization terminated successfully. (HiGHS Status 7: Optimal)
Min-cost-flow calculation took 3.18117 secs
Collecting stats...
Total absorbed flow: 7.71248e+06
Total flows:
   absorbed: 7.71248e+06
   assigned: 475830
Total costs:
 assignment: 29577.4
 absorption: 7.71248e+12
      total: 7.71248e+12
Stats collection took 0.544385 secs


Timings (at nX=3486, nY=262144):
distList: 0.636887 secs
containmentCheck: 3.87416 secs
flowNetGeneration: 0.506509 secs
minCostFlow: 3.18117 secs
statsCollection: 0.544385 secs
Saved MCF result to '/home/leo/repos/mcfnmr-release/output/cache_demo_routines/mcfResult_joint_in_N987(raster, (1x2)-bins)_lib_MetaboMiner_0.1on[0.02,0.03,0.04,0.05,0.06,0.08].pickle'
Total time for MCF: 8.88383 secs

Saved updated result to '/home/leo/repos/mcfnmr-release/output/cache_demo_routines/mcfResult_joint_in_N987(raster, (1x2)-bins)_lib_MetaboMiner_0.1on[0.02,0.03,0.04,0.05,0.06,0.08].pickle'
Saved updated result to '/home/leo/repos/mcfnmr-release/output/cache_demo_routines/mcfResult_joint_in_N987(raster, (1x2)-bins)_lib_MetaboMiner_0.08on[0.02,0.03,0.04,0.05,0.06].pickle'

Incremental fit:
   total reserved capacity: 6.30627e+06
    min/max: 0/78469.7

Making dist list for ar=0.12 ...
len(distList): 236387
Saved distlists to '/home/leo/repos/mcfnmr-release/output/cache/mcf/dist_list_N987(raster, (1x2)-bins)_MetaboMiner_ar0.12.pickle'
makeDistList() took 0.742296 secs
Checking containment...
Saved indices to /home/leo/repos/mcfnmr-release/output/cache/mcf/lib MetaboMiner in N987(raster, (1x2)-bins)_region_ix.pickle
Saved indices to /home/leo/repos/mcfnmr-release/output/cache/mcf/N987(raster, (1x2)-bins)_region_ix.pickle
Containment checking took 3.88495 secs
Generating flow net...
No peak of 132 in considered region.
No peak of 1366 in considered region.
No peak of 142 in considered region.
No peak of 157 in considered region.
No peak of 292 in considered region.
No peak of 34 in considered region.
No peak of 4816 in considered region.

Total connected target nodes: 37454
Total target weight: 7.71248e+06

Generated flowNet:
 DiGraph with 41305 nodes and 239967 edges
Generation took 0.810691 secs
Calculating min cost flow...
Constructing A_eq...
Number of dead end compounds: 7 / 501
   took 0.473099 secs
Constructing A_ub...
Estimated number of inequalities: 37454 (nr of connected target nodes).
True number of inequalities is 37454.
   took 2.28215 secs
Running linprog()...
   took 0.593045 secs

linprog:
Optimization terminated successfully. (HiGHS Status 7: Optimal)
Min-cost-flow calculation took 3.66172 secs
Collecting stats...
Total absorbed flow: 7.40146e+06
Total flows:
   absorbed: 7.40146e+06
   assigned: 311015
Total costs:
 assignment: 26124.1
 absorption: 7.40146e+12
      total: 7.40146e+12
Stats collection took 0.69365 secs


Timings (at nX=3486, nY=262144):
distList: 0.742296 secs
containmentCheck: 3.88495 secs
flowNetGeneration: 0.810691 secs
minCostFlow: 3.66172 secs
statsCollection: 0.69365 secs
Saved MCF result to '/home/leo/repos/mcfnmr-release/output/cache_demo_routines/mcfResult_joint_in_N987(raster, (1x2)-bins)_lib_MetaboMiner_0.12on[0.02,0.03,0.04,0.05,0.06,0.08,0.1].pickle'
Total time for MCF: 9.93753 secs

Saved updated result to '/home/leo/repos/mcfnmr-release/output/cache_demo_routines/mcfResult_joint_in_N987(raster, (1x2)-bins)_lib_MetaboMiner_0.12on[0.02,0.03,0.04,0.05,0.06,0.08,0.1].pickle'
Saved updated result to '/home/leo/repos/mcfnmr-release/output/cache_demo_routines/mcfResult_joint_in_N987(raster, (1x2)-bins)_lib_MetaboMiner_0.1on[0.02,0.03,0.04,0.05,0.06,0.08].pickle'

Incremental fit:
   total reserved capacity: 6.61729e+06
    min/max: 0/78469.7

Making dist list for ar=0.15 ...
len(distList): 369353
Saved distlists to '/home/leo/repos/mcfnmr-release/output/cache/mcf/dist_list_N987(raster, (1x2)-bins)_MetaboMiner_ar0.15.pickle'
makeDistList() took 0.87421 secs
Checking containment...
Saved indices to /home/leo/repos/mcfnmr-release/output/cache/mcf/lib MetaboMiner in N987(raster, (1x2)-bins)_region_ix.pickle
Saved indices to /home/leo/repos/mcfnmr-release/output/cache/mcf/N987(raster, (1x2)-bins)_region_ix.pickle
Containment checking took 3.88568 secs
Generating flow net...
No peak of 132 in considered region.
No peak of 1366 in considered region.
No peak of 142 in considered region.
No peak of 157 in considered region.
No peak of 292 in considered region.
No peak of 34 in considered region.
No peak of 4816 in considered region.

Total connected target nodes: 44028
Total target weight: 7.40146e+06

Generated flowNet:
 DiGraph with 47879 nodes and 372716 edges
Generation took 1.09004 secs
Calculating min cost flow...
Constructing A_eq...
Number of dead end compounds: 7 / 501
   took 0.674473 secs
Constructing A_ub...
Estimated number of inequalities: 44028 (nr of connected target nodes).
True number of inequalities is 44028.
   took 2.63271 secs
Running linprog()...
   took 1.20568 secs

linprog:
Optimization terminated successfully. (HiGHS Status 7: Optimal)
Min-cost-flow calculation took 4.9717 secs
Collecting stats...
Total absorbed flow: 6.83787e+06
Total flows:
   absorbed: 6.83787e+06
   assigned: 563589
Total costs:
 assignment: 57542.8
 absorption: 6.83787e+12
      total: 6.83787e+12
Stats collection took 0.921876 secs


Timings (at nX=3486, nY=262144):
distList: 0.87421 secs
containmentCheck: 3.88568 secs
flowNetGeneration: 1.09004 secs
minCostFlow: 4.9717 secs
statsCollection: 0.921876 secs
Saved MCF result to '/home/leo/repos/mcfnmr-release/output/cache_demo_routines/mcfResult_joint_in_N987(raster, (1x2)-bins)_lib_MetaboMiner_0.15on[0.02,0.03,0.04,0.05,0.06,0.08,0.1,0.12].pickle'
Total time for MCF: 11.8832 secs

Saved updated result to '/home/leo/repos/mcfnmr-release/output/cache_demo_routines/mcfResult_joint_in_N987(raster, (1x2)-bins)_lib_MetaboMiner_0.15on[0.02,0.03,0.04,0.05,0.06,0.08,0.1,0.12].pickle'
Saved updated result to '/home/leo/repos/mcfnmr-release/output/cache_demo_routines/mcfResult_joint_in_N987(raster, (1x2)-bins)_lib_MetaboMiner_0.12on[0.02,0.03,0.04,0.05,0.06,0.08,0.1].pickle'
Classification results:
{'N987': {'classification': {'FN': ['142', '201', '42', '714', '883'],
                             'FP': ['1414', '943'],
                             'TP': ['108',
                                    '112',
                                    '162',
                                    '167',
                                    '182',
                                    '1844',
                                    '211',
                                    '214',
                                    '45',
                                    '660',
                                    '687',
                                    '696',
                                    '8',
                                    '812',
                                    '875',
                                    '904'],
                             'compound_df':     compound target  ... intensity scaling  expected concentration factor
0          1   N987  ...              None                           None
1        101   N987  ...              None                           None
2       1044   N987  ...              None                           None
3       1046   N987  ...              None                           None
4       1049   N987  ...              None                           None
..       ...    ...  ...               ...                            ...
496       97   N987  ...              None                           None
497      975   N987  ...              None                           None
498       98   N987  ...              None                           None
499       99   N987  ...              None                           None
500      995   N987  ...              None                           None

[501 rows x 15 columns],
                             'fscore': 0.8205128205128205,
                             'precision': 0.8888888888888888,
                             'recall': 0.7619047619047619},
          'classificationThreshold': 0.007}}

 Total run time: 73.44648432731628 secs
